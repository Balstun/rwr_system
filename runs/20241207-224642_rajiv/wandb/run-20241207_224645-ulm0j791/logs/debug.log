2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_setup.py:_flush():79] Current SDK version is 0.18.7
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_setup.py:_flush():79] Configure stats pid to 5443
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_setup.py:_flush():79] Loading settings from /home/ubuntu/.config/wandb/settings
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_setup.py:_flush():79] Loading settings from /home/ubuntu/biomimic/srl_il/wandb/settings
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_setup.py:_flush():79] Loading settings from environment variables: {}
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_setup.py:_flush():79] Applying setup settings: {'mode': 'online', '_disable_service': None}
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_setup.py:_flush():79] Inferring run settings from compute environment: {'program_relpath': 'scripts/run_pipeline.py', 'program_abspath': '/home/ubuntu/biomimic/srl_il/scripts/run_pipeline.py', 'program': '/home/ubuntu/biomimic/srl_il/scripts/run_pipeline.py'}
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_setup.py:_flush():79] Applying login settings: {}
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_init.py:_log_setup():533] Logging user logs to runs/20241207-224642_rajiv/wandb/run-20241207_224645-ulm0j791/logs/debug.log
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_init.py:_log_setup():534] Logging internal logs to runs/20241207-224642_rajiv/wandb/run-20241207_224645-ulm0j791/logs/debug-internal.log
2024-12-07 22:46:45,422 INFO    MainThread:5443 [wandb_init.py:init():619] calling init triggers
2024-12-07 22:46:45,423 INFO    MainThread:5443 [wandb_init.py:init():626] wandb.init called with sweep_config: {}
config: {'batch_size': 100, 'seed': 43, 'debugrun': True, 'wandb_cfg': {'project': 'rajiv', 'run_name': '20241207-224642_rajiv', 'tags': ['test', 'act'], 'mode': 'online'}, 'output_dir': 'runs/20241207-224642_rajiv', 'pipeline': {'_target_': 'srl_il.pipeline.imitation_learning.ImitationLearningPipeline'}, 'dataset_cfg': {'data': {'_target_': 'srl_il.dataset.test_dataset.test_train_robomimic', 'data_directory': 'data_12_02_2024/processed', 'test_fraction': 0.1, 'val_fraction': 0.1, 'window_size_train': 20, 'window_size_test': 20, 'keys_traj': [['actions_hand', 'actions_hand', 0, None], ['qpos_hand', 'qpos_hand', 0, 1], ['oakd_side_view_images', 'oakd_side_view/color', 0, 1]], 'keys_global': [], 'pad_before': False, 'pad_after': True, 'pad_type': 'near', 'random_seed': 43}, 'batch_size': 100, 'pin_memory': True, 'num_workers': 2}, 'algo_cfg': {'_target_': 'srl_il.algo.act.ACTPolicyTrainer', 'algo_cfg': {'device': 'cuda', 'target_dims': {'actions_hand': 16}, 'z_dim': 32, 'T_target': 20, 'T_z': 1, 'encoder_is_causal': False, 'decoder_is_causal': True, 'encoder_group_keys': ['qpos'], 'decoder_group_keys': ['qpos', 'oakd_side_view_images'], 'encoder_cfg': {'d_model': 256, 'nhead': 8, 'num_encoder_layers': 3, 'dim_feedforward': 1024, 'dropout': 0.1, 'activation': 'relu'}, 'decoder_cfg': {'d_model': 256, 'nhead': 8, 'num_encoder_layers': 3, 'dim_feedforward': 1024, 'dropout': 0.1, 'activation': 'relu'}}, 'trainer_cfg': {'loss_params': {'kl_weight': 10}, 'optimizer_cfg': {'act_encoder': {'optm_cls': 'torch.optim.Adam', 'lr': 0.0001}, 'act_decoder': {'optm_cls': 'torch.optim.Adam', 'lr': 0.0001}, 'obs_encoder': {'optm_cls': 'torch.optim.Adam', 'lr': 0.0001}, 'projs': {'optm_cls': 'torch.optim.Adam', 'lr': 0.0001}, 'embeds': {'optm_cls': 'torch.optim.Adam', 'lr': 0.0001}}}, 'obs_encoder_cfg': {'output_dim': 256, 'obs_groups_cfg': {'qpos': {'datakeys': ['qpos_hand'], 'encoder_cfg': {'type': 'lowdim_concat', 'input_dim_total': 16}, 'posemb_cfg': {'type': 'none'}}, 'oakd_side_view_images': {'datakeys': ['oakd_side_view_images'], 'encoder_cfg': {'type': 'crop_resnet18', 'resize_shape': [270, 480], 'crop_shape': [224, 352], 'pretrained': True}, 'posemb_cfg': {'type': 'none'}}}, 'group_emb_cfg': {'type': 'whole_seq_sine'}}, 'policy_cfg': {'policy_bs': 1, 'policy_translator': None, 'policy_aggregator_cfg': {'type': 'temporal_aggr', 'update_every': 1, 'k': 0.01}, 'policy_obs_list': [['qpos_hand', 1], ['oakd_side_view_images', 2]]}}, 'lr_scheduler_cfg': {'act_encoder': {'type': 'torch', 'scheduler_cls': 'torch.optim.lr_scheduler.StepLR', 'params': {'step_size': 1000, 'gamma': 0.95}, 'step_with_metrics': False}, 'act_decoder': {'type': 'torch', 'scheduler_cls': 'torch.optim.lr_scheduler.StepLR', 'params': {'step_size': 10000, 'gamma': 0.95}, 'step_with_metrics': False}, 'obs_encoder': {'type': 'torch', 'scheduler_cls': 'torch.optim.lr_scheduler.StepLR', 'params': {'step_size': 10000, 'gamma': 0.95}, 'step_with_metrics': False}}, 'training_cfg': {'num_epochs': 5, 'num_steps_per_epoch': 10, 'num_eval_steps_per_epoch': 2, 'steps_saving': 10, 'rollout': {'enabled': False}, 'visualization': {'enabled': True, 'num_samples': 5, 'every_n_epoch': 10}}, 'normalizer_cfg': {'actions_hand': {'type': 'dataset_stats', 'min_max': True, 'dataname': 'actions_hand'}, 'qpos_hand': {'type': 'dataset_stats', 'dataname': 'qpos_hand'}, 'oakd_side_view_images': {'type': 'hardcode', 'mean': [[[0.485]], [[0.456]], [[0.406]]], 'std': [[[0.229]], [[0.224]], [[0.225]]]}}, 'data_augmentation_cfg': {'data_augments': [{'outname': 'qpos_hand', 'type': 'gaussian_noise', 'mean': 0.0, 'std': 0.01}]}, 'sim_env_cfg': {}, 'projection_visualizer_cfg': {}}
2024-12-07 22:46:45,423 INFO    MainThread:5443 [wandb_init.py:init():669] starting backend
2024-12-07 22:46:45,423 INFO    MainThread:5443 [wandb_init.py:init():673] sending inform_init request
2024-12-07 22:46:45,423 INFO    MainThread:5443 [backend.py:_multiprocessing_setup():104] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-12-07 22:46:45,424 INFO    MainThread:5443 [wandb_init.py:init():686] backend started and connected
2024-12-07 22:46:45,426 INFO    MainThread:5443 [wandb_init.py:init():781] updated telemetry
2024-12-07 22:46:45,429 INFO    MainThread:5443 [wandb_init.py:init():814] communicating run to backend with 90.0 second timeout
2024-12-07 22:46:45,810 INFO    MainThread:5443 [wandb_init.py:init():867] starting run threads in backend
2024-12-07 22:46:45,923 INFO    MainThread:5443 [wandb_run.py:_console_start():2456] atexit reg
2024-12-07 22:46:45,923 INFO    MainThread:5443 [wandb_run.py:_redirect():2305] redirect: wrap_raw
2024-12-07 22:46:45,924 INFO    MainThread:5443 [wandb_run.py:_redirect():2370] Wrapping output streams.
2024-12-07 22:46:45,924 INFO    MainThread:5443 [wandb_run.py:_redirect():2395] Redirects installed.
2024-12-07 22:46:45,925 INFO    MainThread:5443 [wandb_init.py:init():911] run started, returning control to user process
2024-12-07 22:48:33,208 WARNING MsgRouterThr:5443 [router.py:message_loop():75] message_loop has been closed
